//
//  main.c
//  version_Haskell_bit
//
//  Created by Yu Xiang on 11/1/16.
//  Copyright Â© 2016 Yu Xiang. All rights reserved.
//


// recent changes: 1. Changed all malloc()s to calloc()s. calloc() initializes memory, as well as allocating.
//                    This could very easily be changed back for speed efficiency, but it kept showing up as an error in valgrind.
//                 2. Added a return value of 2. Now 0 is success, 1 is memory allocation error, 2 is inputs were both 0 length.
//                 3. Changed strncpy(retAlign, _, _) to be a series of loops, each terminating at '*'.
//                    Also terminated both strings with '\0', for good measure.
//                 4. Made INIT_LENGTH a const.
//                 5. INIT_LENGTH = 2 * retAlign->alignmentLength - 1.
//                 6. Made LENGTH a const.
//                 7. Some style changes to enhance legibility for myself.

#include <inttypes.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

#include "costMatrixWrapper.h"
#include "dynamicCharacterOperations.h"
//#include "seqAlignForHaskell.h"
#include "seqAlignInterface.h"

#define __STDC_FORMAT_MACROS

int main() {

    const size_t TCM_LENGTH    = 64;
    const size_t ALPHABET_SIZE = 8;

    int tcm[1421] = {217, 27, 114, 100, 171, 31, 182, 164, 16, 114, 246, 61, 137, 88, 248, 214, 96, 188, 209, 25, 211, 2, 15, 232, 59, 163, 83, 203, 170, 186, 213, 85, 193, 81, 32, 166, 143, 168, 159, 2, 18, 231, 122, 75, 202, 9, 81, 255, 149, 84, 101, 216, 202, 233, 57, 35, 40, 127, 45, 126, 43, 211, 141, 59, 48, 205, 250, 111, 95, 9, 66, 5, 159, 137, 138, 140, 17, 207, 116, 5, 135, 186, 151, 192, 183, 153, 205, 82, 151, 37, 236, 234, 117, 188, 103, 191, 105, 123, 99, 127, 246, 40, 48, 173, 102, 27, 27, 38, 39, 169, 173, 12, 241, 167, 103, 40, 167, 53, 185, 81, 253, 164, 122, 173, 137, 193, 99, 94, 20, 185, 125, 160, 108, 128, 220, 43, 50, 200, 188, 87, 35, 201, 151, 57, 19, 196, 133, 172, 246, 229, 60, 251, 113, 34, 143, 80, 82, 65, 148, 41, 175, 117, 177, 192, 33, 244, 25, 27, 52, 136, 176, 233, 33, 195, 66, 237, 39, 138, 69, 224, 36, 32, 237, 171, 214, 110, 107, 189, 186, 109, 145, 151, 20, 212, 112, 231, 30, 247, 87, 188, 242, 245, 214, 161, 81, 108, 167, 210, 246, 112, 247, 227, 223, 208, 111, 156, 72, 235, 57, 210, 97, 118, 109, 255, 89, 148, 230, 229, 137, 93, 84, 55, 146, 212, 136, 31, 204, 151, 106, 197, 120, 180, 248, 198, 127, 70, 183, 203, 252, 172, 45, 125, 210, 163, 119, 178, 8, 113, 35, 132, 99, 73, 95, 76, 58, 20, 180, 124, 30, 182, 254, 217, 232, 60, 89, 42, 105, 245, 233, 113, 174, 156, 33, 117, 227, 137, 175, 130, 218, 203, 242, 108, 50, 253, 4, 55, 152, 157, 218, 145, 138, 152, 23, 242, 227, 213, 178, 18, 13, 49, 203, 147, 81, 16, 245, 31, 84, 195, 146, 21, 75, 140, 214, 5, 31, 43, 33, 29, 26, 120, 20, 76, 16, 97, 211, 43, 202, 218, 14, 241, 180, 129, 21, 182, 35, 121, 126, 132, 224, 248, 239, 184, 213, 64, 170, 166, 19, 3, 31, 136, 251, 222, 42, 142, 128, 247, 129, 62, 2, 102, 76, 5, 201, 131, 22, 68, 235, 212, 248, 44, 78, 11, 188, 146, 104, 73, 226, 128, 196, 131, 152, 219, 66, 51, 42, 172, 217, 61, 128, 160, 178, 138, 115, 139, 99, 130, 88, 94, 136, 135, 107, 196, 238, 180, 61, 207, 97, 114, 163, 45, 76, 148, 38, 95, 223, 182, 10, 252, 64, 189, 129, 79, 141, 69, 253, 124, 204, 206, 79, 36, 207, 245, 31, 139, 223, 13, 85, 76, 127, 223, 211, 74, 170, 70, 213, 204, 181, 86, 39, 40, 226, 80, 169, 76, 115, 180, 50, 50, 35, 132, 111, 65, 70, 76, 120, 215, 2, 233, 40, 237, 20, 76, 41, 241, 178, 54, 184, 234, 92, 14, 179, 171, 103, 132, 1, 181, 155, 74, 118, 187, 168, 61, 7, 223, 229, 182, 238, 84, 243, 205, 24, 33, 97, 177, 1, 130, 181, 207, 129, 110, 105, 49, 173, 222, 252, 116, 165, 23, 118, 85, 78, 205, 86, 175, 50, 219, 243, 214, 56, 221, 19, 115, 73, 63, 124, 42, 216, 215, 203, 119, 126, 125, 81, 199, 247, 129, 254, 17, 201, 174, 8, 155, 181, 168, 179, 152, 227, 54, 223, 231, 21, 175, 84, 151, 103, 124, 72, 184, 113, 178, 157, 237, 219, 117, 39, 156, 172, 71, 164, 154, 23, 42, 39, 175, 225, 253, 56, 215, 111, 132, 136, 27, 36, 196, 159, 197, 190, 248, 14, 16, 247, 56, 212, 65, 216, 82, 26, 152, 193, 7, 243, 14, 245, 42, 116, 248, 212, 238, 50, 160, 247, 195, 178, 252, 151, 136, 185, 239, 157, 115, 253, 144, 97, 68, 191, 115, 159, 138, 56, 129, 244, 71, 44, 208, 57, 109, 37, 2, 119, 241, 141, 189, 108, 81, 88, 250, 126, 240, 114, 145, 251, 117, 50, 235, 204, 20, 192, 7, 123, 193, 176, 94, 174, 6, 254, 194, 211, 182, 30, 54, 255, 255, 108, 128, 255, 68, 206, 69, 19, 157, 206, 220, 39, 79, 95, 54, 248, 31, 92, 22, 37, 208, 120, 74, 56, 227, 43, 149, 170, 176, 162, 18, 86, 18, 153, 125, 254, 117, 58, 42, 159, 242, 39, 1, 204, 172, 15, 118, 104, 99, 50, 81, 110, 216, 71, 75, 132, 202, 136, 122, 198, 247, 56, 60, 147, 55, 126, 193, 204, 237, 169, 24, 117, 68, 201, 246, 13, 167, 155, 208, 26, 199, 214, 74, 19, 7, 207, 193, 160, 82, 218, 132, 235, 212, 165, 219, 141, 230, 222, 168, 62, 99, 37, 62, 47, 248, 176, 92, 22, 126, 106, 46, 216, 108, 149, 66, 53, 129, 89, 152, 202, 153, 15, 117, 200, 181, 237, 222, 185, 178, 222, 51, 182, 15, 219, 49, 84, 42, 158, 231, 101, 173, 252, 232, 45, 75, 175, 38, 19, 182, 255, 22, 51, 77, 202, 253, 92, 97, 60, 153, 201, 94, 202, 79, 237, 141, 245, 161, 11, 199, 190, 41, 41, 72, 87, 167, 253, 8, 37, 4, 246, 87, 93, 130, 253, 150, 116, 96, 62, 25, 14, 146, 4, 90, 165, 137, 108, 134, 2, 27, 245, 38, 204, 143, 27, 53, 102, 37, 99, 161, 11, 158, 93, 199, 243, 100, 166, 201, 238, 193, 106, 50, 121, 126, 138, 251, 198, 247, 116, 214, 118, 9, 84, 170, 210, 172, 26, 20, 1, 38, 201, 137, 53, 237, 72, 218, 97, 210, 56, 40, 162, 73, 128, 90, 47, 197, 249, 224, 227, 103, 255, 133, 53, 60, 227, 239, 26, 85, 200, 177, 119, 146, 90, 53, 156, 49, 231, 7, 48, 99, 46, 250, 65, 139, 12, 57, 141, 180, 90, 177, 56, 200, 183, 96, 65, 223, 101, 187, 177, 26, 168, 39, 4, 222, 166, 96, 102, 111, 50, 190, 213, 75, 53, 198, 29, 93, 105, 85, 162, 73, 33, 222, 109, 156, 139, 6, 32, 110, 62, 29, 209, 20, 192, 96, 76, 22, 89, 174, 29, 215, 250, 244, 21, 136, 4, 120, 157, 105, 23, 198, 173, 18, 54, 57, 246, 32, 144, 148, 19, 23, 156, 201, 70, 65, 242, 209, 78, 85, 155, 63, 113, 201, 13, 163, 245, 248, 99, 160, 66, 100, 136, 21, 42, 6, 9, 113, 1, 162, 141, 82, 31, 224, 153, 57, 173, 193, 22, 145, 61, 4, 99, 58, 51, 201, 191, 20, 146, 232, 78, 48, 237, 4, 79, 233, 25, 74, 48, 85, 242, 227, 25, 230, 213, 185, 188, 116, 246, 189, 184, 54, 200, 238, 59, 156, 170, 183, 160, 132, 187, 38, 193, 77, 142, 44, 241, 151, 92, 52, 20, 240, 93, 202, 131, 207, 206, 236, 95, 106, 66, 38, 112, 81, 8, 55, 211, 174, 188, 98, 155, 18, 58, 151, 66, 102, 204, 164, 22, 159, 105, 175, 232, 59, 93, 99, 133, 92, 161, 35, 129, 78, 236, 196, 130, 250, 249, 55, 128, 122, 180, 240, 140, 14, 140, 238, 100, 5, 130, 76, 159, 124, 238, 125, 108, 82, 150, 77, 168, 220, 237, 127, 159, 60, 111, 38, 60, 80, 125, 109, 30, 143, 81, 100, 169, 148, 177, 37, 177, 4, 45, 93, 233, 235, 46, 161, 123, 153, 151, 16, 90, 145, 115, 164, 234, 30, 130, 183, 207, 62, 65, 232, 242, 42, 71, 249, 43, 57, 140, 42, 25, 159, 57, 96, 157, 204, 252, 56, 223, 11, 174, 71, 212, 185, 143, 144, 245, 50, 33, 150, 218, 189, 4, 127, 113, 212, 50, 190, 178, 177, 89, 253, 244, 211, 127, 244, 72, 74, 137, 250, 91, 67, 249, 244, 200, 196, 85, 104, 128, 59, 1, 142, 169, 72, 247, 174, 95, 135, 211, 59, 90, 145, 155, 155, 72, 180, 82, 152, 21, 46, 161, 227, 197, 19, 199, 153, 60, 231, 107, 120, 211, 26, 254, 76, 136, 58, 123, 145, 81, 32, 10, 226, 3, 152, 251, 108, 16, 210, 149, 138, 255, 36, 187, 223, 255, 160, 4, 97, 227, 72, 48, 215, 107, 53, 2, 136, 186, 194, 4, 18, 252, 78, 103, 163, 124, 45, 49, 106, 110, 99, 185, 24, 9, 117, 203, 135, 45, 209, 232, 17, 52, 24, 137, 129, 235, 118, 174, 108, 117, 102, 22, 84, 158, 210, 209, 128, 134, 96, 109, 217, 97, 154, 216};

    if ( TCM_LENGTH != ALPHABET_SIZE * ALPHABET_SIZE ) {
        printf("tcm wrong size\n");
        exit(1);
    }

    uint64_t s1[50] = {9, 226, 122, 110, 52, 213, 212, 104, 226, 250, 20, 26, 100, 106, 236, 60, 44, 63, 176, 220, 199, 251, 232, 196, 132, 137, 43, 96, 226, 145, 197, 146, 141, 221, 108, 160, 227, 196, 109, 84, 96, 154, 82, 117, 190, 92, 98, 103, 159, 104};

    uint64_t s2[1220] = {195, 27, 26, 184, 136, 69, 41, 152, 17, 215, 165, 243, 71, 179, 158, 252, 179, 2, 170, 171, 198, 145, 115, 67, 216, 157, 249, 115, 218, 172, 110, 146, 244, 135, 55, 51, 30, 34, 168, 241, 61, 106, 50, 208, 118, 37, 65, 85, 4, 146, 35, 251, 176, 231, 155, 228, 218, 15, 65, 140, 181, 184, 241, 164, 103, 100, 51, 131, 36, 12, 219, 33, 181, 250, 16, 129, 147, 101, 167, 221, 145, 116, 48, 68, 177, 167, 169, 70, 151, 134, 25, 51, 54, 97, 72, 244, 18, 115, 133, 159, 241, 2, 245, 127, 170, 167, 203, 213, 13, 141, 36, 127, 91, 184, 6, 187, 248, 128, 252, 8, 209, 167, 110, 161, 38, 121, 72, 32, 247, 105, 211, 84, 159, 180, 115, 56, 134, 21, 106, 115, 242, 120, 154, 186, 84, 30, 18, 191, 172, 184, 11, 169, 10, 194, 38, 97, 200, 253, 51, 233, 125, 188, 143, 204, 127, 249, 36, 60, 171, 9, 149, 205, 139, 4, 90, 81, 137, 35, 60, 143, 108, 57, 183, 184, 173, 214, 25, 69, 187, 231, 16, 92, 115, 227, 80, 29, 251, 50, 70, 183, 12, 251, 38, 143, 228, 167, 74, 184, 168, 105, 47, 23, 164, 50, 85, 127, 81, 153, 193, 133, 106, 196, 146, 100, 18, 192, 245, 150, 176, 147, 86, 157, 144, 151, 27, 241, 112, 173, 92, 27, 16, 194, 30, 44, 115, 228, 199, 172, 244, 196, 232, 203, 159, 174, 18, 18, 225, 109, 154, 76, 50, 10, 113, 92, 38, 102, 161, 167, 122, 81, 222, 161, 215, 81, 178, 47, 43, 14, 248, 7, 81, 74, 107, 35, 58, 110, 108, 1, 140, 250, 200, 44, 72, 206, 44, 218, 77, 192, 172, 120, 94, 42, 103, 82, 27, 151, 224, 162, 5, 57, 82, 116, 148, 210, 218, 247, 82, 44, 83, 188, 225, 95, 45, 155, 154, 109, 98, 65, 97, 15, 19, 141, 116, 25, 20, 159, 70, 85, 235, 65, 156, 161, 245, 204, 245, 36, 195, 31, 88, 191, 226, 196, 191, 195, 202, 172, 90, 142, 102, 152, 199, 121, 134, 16, 104, 229, 166, 143, 213, 12, 169, 65, 178, 127, 46, 248, 71, 128, 80, 12, 179, 112, 143, 176, 253, 158, 116, 253, 86, 209, 19, 221, 188, 39, 79, 153, 230, 37, 199, 3, 229, 207, 205, 176, 194, 26, 108, 6, 222, 49, 55, 128, 83, 239, 129, 169, 186, 59, 70, 83, 22, 222, 13, 88, 163, 114, 97, 59, 94, 80, 187, 219, 193, 81, 144, 181, 163, 40, 124, 23, 224, 162, 141, 6, 2, 31, 243, 26, 79, 59, 90, 10, 60, 240, 203, 253, 41, 41, 185, 123, 143, 226, 36, 215, 114, 227, 87, 156, 175, 71, 130, 184, 19, 172, 226, 56, 8, 84, 19, 94, 49, 148, 84, 156, 240, 51, 38, 165, 15, 196, 211, 195, 57, 198, 139, 43, 67, 100, 237, 86, 208, 47, 22, 174, 34, 224, 132, 7, 57, 16, 248, 119, 130, 73, 6, 1, 106, 238, 124, 183, 145, 178, 37, 1, 27, 24, 70, 16, 228, 47, 139, 137, 5, 36, 11, 46, 225, 20, 2, 204, 234, 59, 222, 228, 73, 163, 154, 2, 220, 13, 253, 174, 182, 168, 211, 219, 210, 2, 189, 237, 116, 43, 34, 192, 51, 28, 82, 125, 117, 236, 66, 204, 211, 4, 165, 148, 40, 116, 109, 236, 220, 255, 129, 172, 37, 242, 142, 107, 157, 128, 170, 205, 251, 73, 80, 151, 55, 35, 220, 235, 38, 83, 89, 161, 159, 84, 153, 124, 184, 43, 221, 152, 62, 232, 123, 243, 137, 210, 78, 39, 50, 142, 132, 3, 106, 88, 246, 222, 252, 75, 226, 73, 116, 110, 233, 143, 217, 188, 124, 121, 243, 104, 91, 37, 171, 25, 239, 18, 27, 11, 73, 159, 21, 66, 207, 74, 161, 153, 162, 182, 51, 254, 224, 204, 56, 3, 96, 2, 110, 2, 75, 245, 43, 231, 66, 112, 182, 98, 41, 91, 132, 158, 233, 116, 223, 52, 106, 177, 221, 129, 178, 200, 135, 63, 60, 24, 69, 176, 48, 75, 151, 209, 30, 175, 237, 12, 218, 248, 250, 178, 134, 97, 45, 24, 197, 214, 114, 72, 203, 38, 197, 33, 117, 30, 118, 99, 251, 73, 27, 90, 238, 53, 238, 197, 48, 188, 65, 105, 33, 211, 190, 63, 109, 37, 82, 213, 115, 237, 254, 97, 193, 199, 181, 83, 64, 102, 177, 239, 212, 101, 41, 242, 5, 211, 15, 228, 29, 42, 167, 197, 63, 165, 23, 199, 151, 24, 64, 176, 29, 210, 145, 97, 38, 235, 110, 98, 74, 173, 213, 78, 147, 132, 35, 78, 118, 80, 48, 238, 204, 164, 168, 81, 5, 62, 120, 26, 13, 35, 180, 79, 41, 69, 76, 26, 81, 205, 109, 82, 1, 189, 180, 114, 209, 17, 146, 223, 72, 105, 146, 189, 249, 114, 206, 133, 250, 11, 240, 7, 177, 131, 251, 195, 150, 103, 44, 245, 208, 184, 178, 218, 231, 184, 157, 71, 232, 108, 31, 33, 34, 31, 211, 129, 54, 216, 86, 46, 32, 125, 12, 23, 228, 135, 158, 37, 229, 61, 34, 10, 234, 16, 11, 181, 249, 170, 21, 222, 63, 151, 163, 252, 23, 113, 153, 203, 16, 223, 197, 186, 65, 103, 100, 88, 86, 248, 228, 49, 205, 50, 95, 187, 153, 61, 34, 128, 112, 124, 171, 214, 201, 151, 97, 178, 96, 93, 30, 250, 229, 200, 169, 32, 134, 145, 154, 140, 193, 115, 254, 66, 168, 228, 135, 209, 30, 147, 118, 151, 8, 180, 68, 70, 253, 128, 43, 18, 149, 38, 93, 26, 8, 158, 254, 115, 70, 134, 52, 124, 31, 26, 59, 234, 197, 5, 213, 111, 190, 132, 86, 1, 31, 170, 49, 82, 37, 117, 66, 73, 150, 84, 208, 156, 74, 37, 152, 29, 140, 111, 34, 104, 150, 180, 39, 107, 230, 120, 136, 124, 115, 162, 250, 148, 123, 198, 119, 106, 184, 14, 24, 38, 74, 92, 193, 173, 53, 143, 234, 28, 212, 105, 152, 171, 147, 25, 121, 21, 168, 204, 203, 4, 84, 192, 199, 247, 79, 105, 207, 103, 152, 235, 28, 178, 227, 82, 230, 219, 231, 136, 253, 95, 234, 16, 171, 193, 58, 67, 42, 48, 90, 77, 172, 59, 137, 229, 200, 118, 72, 17, 33, 15, 201, 99, 9, 103, 155, 72, 197, 64, 30, 64, 110, 141, 172, 121, 26, 25, 215, 109, 37, 163, 43, 34, 12, 204, 168, 181, 41, 117, 111, 63, 245, 48, 253, 152, 9, 22, 19, 11, 182, 194, 125, 171, 82, 227, 213, 240, 146, 76, 162, 41, 201, 78, 121, 204, 77, 45, 131, 194, 175, 94, 91, 42, 45, 61, 48, 151, 193, 26, 1, 195, 30, 60, 44, 100, 245, 210, 203, 233, 148, 213, 247, 3, 237, 229, 22, 57, 209, 31, 222, 130, 136, 201, 65, 54, 68, 100, 209, 63, 117, 156, 17, 30, 81, 212, 211, 114, 86, 191, 205, 126, 231, 11, 7, 69, 160, 82, 98, 194, 222, 129, 72, 36, 136, 173, 233, 196, 69, 97, 107, 95, 83, 65, 97, 91, 175, 88, 241, 80, 26, 251, 46, 67};

    costMatrix_p costMatrix = matrixInit(ALPHABET_SIZE, tcm);

    dynChar_t *seqA  = malloc(sizeof(dynChar_t));
    seqA->alphSize   = ALPHABET_SIZE;
    seqA->numElems   = 1421;
    seqA->dynCharLen = dynCharSize(ALPHABET_SIZE, seqA->numElems);
    seqA->dynChar    = intArrToBitArr(ALPHABET_SIZE, seqA->numElems, s1);


    dynChar_t *seqB  = malloc(sizeof(dynChar_t));
    seqB->alphSize   = ALPHABET_SIZE;
    seqB->numElems   = 1220;
    seqB->dynCharLen = dynCharSize(ALPHABET_SIZE, seqB->numElems);
    seqB->dynChar    = intArrToBitArr(ALPHABET_SIZE, seqB->numElems, s2);

    int success = 1;


    alignResult_t *result = malloc(sizeof(alignResult_t));

    success = performSequentialAlignment(seqA, seqB, costMatrix, result);

    printf("%zu\n", result->finalLength);

    if (success == 0) {
        printf("\nSuccess!\n\n");
	dynChar_t *seqARes = malloc(sizeof(dynChar_t));
	dynChar_t *seqBRes = malloc(sizeof(dynChar_t));
	dynChar_t *median  = malloc(sizeof(dynChar_t));

        seqARes->alphSize = ALPHABET_SIZE;
        seqBRes->alphSize = ALPHABET_SIZE;
        median ->alphSize = ALPHABET_SIZE;

        seqARes->numElems = result->finalLength;
        seqBRes->numElems = result->finalLength;
        median ->numElems = result->finalLength;

        seqARes->dynCharLen = dynCharSize(seqARes->alphSize, seqARes->numElems);
        seqBRes->dynCharLen = dynCharSize(seqBRes->alphSize, seqBRes->numElems);
        median ->dynCharLen = dynCharSize(median ->alphSize, median ->numElems);

        seqARes->dynChar = result->finalChar1;
        seqBRes->dynChar = result->finalChar2;
        median ->dynChar = result->medianChar;

	printf("Resulting Character 1 Alignment:\n");
        printDynChar(seqARes);
	printf("Resulting Character 2 Alignment:\n");
        printDynChar(seqBRes);
        printf("Median    Character   Alignment:\n");
        printDynChar(median );

        printf("The cost of the alignment is: %zu\n", result->finalWt);

    } else {
        printf("Fail!\n");
    }
    // free(retAlign->seq1);
    // free(retAlign->seq2);
    matrixDestroy(costMatrix);

}


/**
 *  A sample program that takes in two dynamic characters and returns two aligned dynamic chars,
 *  in the form of an alignResult_t. The third character is allocated on Haskell side and passed in by reference.
 *  Returns 0 on correct exit, 1 on allocation failure. This was used to test the Haskell FFI.
 */
/*
int exampleInterfaceFn(dynChar_t* seqA, dynChar_t* seqB, alignResult_t* result) {

    uint64_t* seqA_main = dynCharToIntArr(seqA);
    uint64_t* seqB_main = dynCharToIntArr(seqB);

    retType_t* retAlign = malloc( sizeof(retType_t) );

    long int length = seqA->numElems + seqB->numElems + 5;
    retAlign->seq1 = calloc(length, sizeof(int));
    retAlign->seq2 = calloc(length, sizeof(int));
    if( retAlign->seq1 == NULL || retAlign->seq2 == NULL ) {
        printf("Memory failure!\n");
        return 1;
    }
    retAlign->alignmentLength = length;

    // Call aligner with TCM here: int success = aligner(seqA_main, seqB_main, costMtx_t* tcm, &retAlign);
    // The following as an example
    const size_t TCM_LENGTH = 25;
    int tcm[25] = {0,1,1,1,2, 1,0,1,1,2, 1,1,0,1,2, 1,1,1,0,2, 2,2,2,2,0};
    size_t ALPHABET_SIZE = 5;
    if ( TCM_LENGTH != ALPHABET_SIZE * ALPHABET_SIZE ) {
        printf("tcm wrong size\n");
        exit(1);
    }

    costMatrix_p costMatrix = matrixInit(ALPHABET_SIZE, tcm);

    int success = aligner(seqA_main, seqA->numElems, seqB_main, seqB->numElems, seqA->alphSize, costMatrix, retAlign);
    result->finalChar1 = intArrToBitArr (seqA->alphSize, retAlign->alignmentLength, retAlign->seq1);
    result->finalChar2 = intArrToBitArr (seqA->alphSize, retAlign->alignmentLength, retAlign->seq2);

    result->finalWt      = retAlign->weight;
    result->finalLength  = retAlign->alignmentLength;

    freeRetType(retAlign);
    free(retAlign);

    return success;
}
*/
