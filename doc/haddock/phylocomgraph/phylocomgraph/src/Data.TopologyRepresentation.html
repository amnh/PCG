<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-2"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- Module      :  Data.TopologyRepresentation</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Copyright   :  (c) 2015-2015 Ward Wheeler</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-6"></a><span class="hs-comment">--</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Maintainer  :  wheeler@amnh.org</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Stability   :  provisional</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-10"></a><span class="hs-comment">--</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Set-like structures for collection of edges.</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-pragma">{-# LANGUAGE DeriveGeneric, GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">TopologyRepresentation</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span>
</span><a name="line-19"></a><span>  </span><span class="hs-comment">-- * Construction</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.TopologyRepresentation.html#isolatedNetworkEdgeContext"><span class="hs-identifier hs-var">isolatedNetworkEdgeContext</span></a><span>
</span><a name="line-21"></a><span>  </span><span class="hs-comment">-- * Deconstruct</span><span>
</span><a name="line-22"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.TopologyRepresentation.html#excludedNetworkEdges"><span class="hs-identifier hs-var">excludedNetworkEdges</span></a><span>
</span><a name="line-23"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.TopologyRepresentation.html#includedNetworkEdges"><span class="hs-identifier hs-var">includedNetworkEdges</span></a><span>
</span><a name="line-24"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.TopologyRepresentation.html#mutuallyExclusivePairs"><span class="hs-identifier hs-var">mutuallyExclusivePairs</span></a><span>
</span><a name="line-25"></a><span>  </span><span class="hs-comment">-- * Comparison</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.TopologyRepresentation.html#isCompatableWithTopology"><span class="hs-identifier hs-var">isCompatableWithTopology</span></a><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Data.TopologyRepresentation.html#isEdgePermissibleWith"><span class="hs-identifier hs-var">isEdgePermissibleWith</span></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">DeepSeq</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Functor</span><span class="hs-operator">.</span><span class="hs-identifier">Classes</span><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Hashable</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">MutualExclusionSet</span><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MutualExclusionSet</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">MutualExclusionSet</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">MES</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span>                       </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Generics</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-comment">{-
isCompatableSubtopologyOf :: Ord a =&gt; TopologyRepresentation a -&gt; TopologyRepresentation a -&gt; Bool
isCompatableSubtopologyOf (TR x) (TR y) = isSubsetOf x y
-}</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>
</span><a name="line-47"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-48"></a><span class="hs-comment">-- Represents a collection of network edges and their mutually exclusive edges.</span><span>
</span><a name="line-49"></a><span class="hs-comment">--</span><span>
</span><a name="line-50"></a><span class="hs-comment">-- Often used to represent a unique spanning tree in a phylogenetic DAG.</span><span>
</span><a name="line-51"></a><span class="hs-keyword">newtype</span><span> </span><a name="TopologyRepresentation"><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier">TopologyRepresentation</span></a></a><span> </span><a name="local-6989586621679150886"><a href="#local-6989586621679150886"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="TR"><a href="Data.TopologyRepresentation.html#TR"><span class="hs-identifier">TR</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="unwrap"><a href="Data.TopologyRepresentation.html#unwrap"><span class="hs-identifier">unwrap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MutualExclusionSet</span><span> </span><a href="#local-6989586621679150886"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Hashable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Generic</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">NFData</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">{-
instance Foldable TopologyRepresentation where

    fold = fold . toList
  
    foldMap f = foldMap f . toList

    toList = BM.keysR . unwrap
    

instance Hashable a =&gt; Hashable (TopologyRepresentation a) where

    hashWithSalt salt = foldl' hashWithSalt salt . mutuallyExclusivePairs
  

instance Ord a =&gt; Monoid (TopologyRepresentation a) where

    mappend = (&lt;&gt;)

    mempty  = TR BM.empty
    

instance NFData a =&gt; NFData (TopologyRepresentation a) where

    rnf (TR bm) = BM.fold f () bm `seq` ()
      where
        f x y t = t `seq` rnf x `seq` rnf y


-- |
-- /O(n + m)/
instance Ord a =&gt; Semigroup (TopologyRepresentation a) where

    (TR lhs) &lt;&gt; (TR rhs) = TR . BM.fromAscPairListUnchecked . M.toAscList $ M.unionWith const (BM.toMap lhs) (BM.toMap rhs)
-}</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679151096"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679151096"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span> </span><a href="#local-6989586621679151096"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>    </span><a name="local-8214565720323786117"><span class="hs-identifier">show</span></a><span> </span><a name="local-6989586621679151097"><a href="#local-6989586621679151097"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unwords</span><span>
</span><a name="line-93"></a><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;Network Edges of Topology:&quot;</span><span>
</span><a name="line-94"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151098"><span class="hs-identifier hs-var">showIncluded</span></a><span> </span><a href="#local-6989586621679151097"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-95"></a><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;|&quot;</span><span>
</span><a name="line-96"></a><span>        </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679151099"><span class="hs-identifier hs-var">showExcluded</span></a><span> </span><a href="#local-6989586621679151097"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-97"></a><span>        </span><span class="hs-special">]</span><span>
</span><a name="line-98"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-99"></a><span>        </span><a name="local-6989586621679151098"><a href="#local-6989586621679151098"><span class="hs-identifier">showIncluded</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.TopologyRepresentation.html#includedNetworkEdges"><span class="hs-identifier hs-var">includedNetworkEdges</span></a><span>
</span><a name="line-100"></a><span>        </span><a name="local-6989586621679151099"><a href="#local-6989586621679151099"><span class="hs-identifier">showExcluded</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toList</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.TopologyRepresentation.html#excludedNetworkEdges"><span class="hs-identifier hs-var">excludedNetworkEdges</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- \( \mathcal{O} \left( 1 \right) \)</span><span>
</span><a name="line-105"></a><span class="hs-comment">--</span><span>
</span><a name="line-106"></a><span class="hs-comment">-- Construct a singleton 'TopologyRepresentation' value by supplying a network</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- edge identifier representing an edge contained in the topology and a</span><span>
</span><a name="line-108"></a><span class="hs-comment">-- corresponding network edge identifier representing the mutually exclusive</span><span>
</span><a name="line-109"></a><span class="hs-comment">-- incident edge.</span><span>
</span><a name="line-110"></a><span class="hs-comment">--</span><span>
</span><a name="line-111"></a><span class="hs-comment">-- Use the semigroup operator '(&lt;&gt;)' to merge isolated network edge contexts into</span><span>
</span><a name="line-112"></a><span class="hs-comment">-- a larger 'TopologyRepresentation'.</span><span>
</span><a name="line-113"></a><span class="hs-pragma">{-# INLINE isolatedNetworkEdgeContext #-}</span><span>
</span><a name="line-114"></a><span class="hs-identifier">isolatedNetworkEdgeContext</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679151105"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-116"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151105"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ Included network edge</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679151105"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-comment">-- ^ Excluded incident network edge</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span> </span><a href="#local-6989586621679151105"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-119"></a><a name="isolatedNetworkEdgeContext"><a href="Data.TopologyRepresentation.html#isolatedNetworkEdgeContext"><span class="hs-identifier">isolatedNetworkEdgeContext</span></a></a><span> </span><a name="local-6989586621679151106"><a href="#local-6989586621679151106"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679151107"><a href="#local-6989586621679151107"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.TopologyRepresentation.html#TR"><span class="hs-identifier hs-var">TR</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">MES</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><a href="#local-6989586621679151106"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679151107"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-123"></a><span class="hs-comment">-- \( \mathcal{O} \left( n \right) \) </span><span>
</span><a name="line-124"></a><span class="hs-comment">--</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- Retreive the list of network edge identifiers present in the topology.</span><span>
</span><a name="line-126"></a><span class="hs-pragma">{-# INLINE includedNetworkEdges #-}</span><span>
</span><a name="line-127"></a><span class="hs-identifier">includedNetworkEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span> </span><a href="#local-6989586621679151104"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679151104"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-128"></a><a name="includedNetworkEdges"><a href="Data.TopologyRepresentation.html#includedNetworkEdges"><span class="hs-identifier">includedNetworkEdges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MES</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">includedSet</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unwrap</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-132"></a><span class="hs-comment">-- \( \mathcal{O} \left( n \right) \)</span><span>
</span><a name="line-133"></a><span class="hs-comment">--</span><span>
</span><a name="line-134"></a><span class="hs-comment">-- Retreive the list of network edge identifiers excluded from the topology.</span><span>
</span><a name="line-135"></a><span class="hs-pragma">{-# INLINE excludedNetworkEdges #-}</span><span>
</span><a name="line-136"></a><span class="hs-identifier">excludedNetworkEdges</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span> </span><a href="#local-6989586621679151103"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679151103"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-137"></a><a name="excludedNetworkEdges"><a href="Data.TopologyRepresentation.html#excludedNetworkEdges"><span class="hs-identifier">excludedNetworkEdges</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MES</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">excludedSet</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unwrap</span><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- \( \mathcal{O} \left( n \right) \)</span><span>
</span><a name="line-142"></a><span class="hs-comment">--</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- Retreive the list of network edge identifiers stored in the topology</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- representation.</span><span>
</span><a name="line-145"></a><span class="hs-pragma">{-# INLINE mutuallyExclusivePairs #-}</span><span>
</span><a name="line-146"></a><span class="hs-identifier">mutuallyExclusivePairs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span> </span><a href="#local-6989586621679151102"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Set</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151102"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679151102"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-147"></a><a name="mutuallyExclusivePairs"><a href="Data.TopologyRepresentation.html#mutuallyExclusivePairs"><span class="hs-identifier">mutuallyExclusivePairs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MES</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mutuallyExclusivePairs</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unwrap</span><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-151"></a><span class="hs-comment">-- \( \mathcal{O} \left( m * \log_2 ( \frac {n}{m + 1} ) \right), m \leq n \)</span><span>
</span><a name="line-152"></a><span class="hs-comment">--</span><span>
</span><a name="line-153"></a><span class="hs-comment">-- Perform a subsetting operation to determine is a sub-topology is compatable</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- with another topology.</span><span>
</span><a name="line-155"></a><span class="hs-pragma">{-# INLINE isCompatableWithTopology #-}</span><span>
</span><a name="line-156"></a><span class="hs-identifier">isCompatableWithTopology</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679151101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span> </span><a href="#local-6989586621679151101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span> </span><a href="#local-6989586621679151101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-157"></a><a name="isCompatableWithTopology"><a href="Data.TopologyRepresentation.html#isCompatableWithTopology"><span class="hs-identifier">isCompatableWithTopology</span></a></a><span> </span><a name="local-6989586621679151108"><a href="#local-6989586621679151108"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">MES</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isPermissible</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unwrap</span><span> </span><a href="#local-6989586621679151108"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unwrap</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-161"></a><span class="hs-comment">-- \( \mathcal{O} \left( \log_2 ( n ) \right) \)</span><span>
</span><a name="line-162"></a><span class="hs-comment">--</span><span>
</span><a name="line-163"></a><span class="hs-comment">-- Determine if an edge is compatible with a topology.</span><span>
</span><a name="line-164"></a><span class="hs-identifier">isEdgePermissibleWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679151100"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679151100"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.TopologyRepresentation.html#TopologyRepresentation"><span class="hs-identifier hs-type">TopologyRepresentation</span></a><span> </span><a href="#local-6989586621679151100"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-165"></a><a name="isEdgePermissibleWith"><a href="Data.TopologyRepresentation.html#isEdgePermissibleWith"><span class="hs-identifier">isEdgePermissibleWith</span></a></a><span> </span><a name="local-6989586621679151109"><a href="#local-6989586621679151109"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679151109"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">MES</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">isExcluded</span><span class="hs-special">`</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unwrap</span><span>
</span><a name="line-166"></a></pre></body></html>